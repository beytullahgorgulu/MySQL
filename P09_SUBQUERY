USE sys;

-- ================================= SUBQUERY =================================


CREATE TABLE calisanlar
(
id int,
isim varchar(50),
sehir varchar(50),
maas int,
sirket varchar(20)
);

INSERT INTO calisanlar VALUES(123456789, 'Ali Seker', 'Istanbul', 2500, 'Honda');
INSERT INTO calisanlar VALUES(234567890, 'Ayse Gul', 'Istanbul', 1500, 'Toyota');
INSERT INTO calisanlar VALUES(345678901, 'Veli Yilmaz', 'Ankara', 3000, 'Honda');
INSERT INTO calisanlar VALUES(456789012, 'Veli Yilmaz', 'Izmir', 1000, 'Ford');
INSERT INTO calisanlar VALUES(567890123, 'Veli Yilmaz', 'Ankara', 7000, 'Hyundai');
INSERT INTO calisanlar VALUES(456789012, 'Ayse Gul', 'Ankara', 1500, 'Ford');
INSERT INTO calisanlar VALUES(123456710, 'Fatma Yasa', 'Bursa', 2500, 'Honda');

SELECT * FROM calisanlar;


CREATE TABLE sirketler
(
sirket_id int,
sirket varchar(20),
calisanlar_sayisi int
);

INSERT INTO sirketler VALUES(100, 'Honda', 12000);
INSERT INTO sirketler VALUES(101, 'Ford', 18000);
INSERT INTO sirketler VALUES(102, 'Hyundai', 10000);
INSERT INTO sirketler VALUES(103, 'Toyota', 21000);
SELECT * FROM sirketler;
SELECT * FROM calisanlar;

-- ======================== WHERE ile SUBQUERY ===========================

--  Personel sayisi 15.000'den cok olan sirketlerin isimlerini
-- ve bu sirkette calisan personelin isimlerini listeleyin

-- 1. ADIM
SELECT sirket 
FROM sirketler
WHERE calisanlar_sayisi > 15000; -- ford ve toyota
-- 2. Adim
SELECT isim
FROM calisanlar
WHERE sirket IN('Ford','Toyota');

-- 3. Adim
SELECT isim, sirket
FROM calisanlar
WHERE sirket IN(SELECT sirket 
                FROM sirketler
                WHERE calisanlar_sayisi > 15000);
                
-- Honda sirketinin calisanlar sayisini 16000 olarak guncelleyiniz
UPDATE sirketler                
SET calisanlar_sayisi = 16000                
WHERE sirket='Honda';  

-- Ford sirketinin calisanlar sayisini 13000 olarak guncelleyiniz

UPDATE sirketler
SET calisanlar_sayisi =13000
WHERE sirket='Ford';          

-- Sirket id'si 101 den buyuk olan sirketteki calisanlarin 
-- maas, sehir ve sirket bilgilerini goruntuleyin.

SELECT isim, maas, sehir, sirket
FROM calisanlar
WHERE sirket IN( SELECT sirket
				 FROM sirketler
                 WHERE sirket_id > 101);

-- - Sirketler tablosuna 104 id ile Volkswagen'i bir sirket olarak ekleyin

insert into sirketler VALUES(104, 'Volkswagen', 20000);
-- Calisanlar tablosuna volkswagen'da calisan bir personel ekleyiniz.


insert into calisanlar  VALUES(456755512, 'Ali Can', 'Izmir', 1007, 'volkswagen');

-- Ankarada calisani olan sirketlerin adi, sirket id ve calisan sayilarini
-- listeleyiniz

SELECT * 
FROM sirketler
WHERE sirket IN (SELECT sirket
				 FROM calisanlar
                 WHERE sehir= 'Ankara');

-- Veli Yilmaz isimli personelin calistigi sirketlerin sirket 
--  ismini ve personel sayilarini listeleyiniz.

SELECT sirket, calisanlar_sayisi
FROM sirketler
WHERE sirket IN (SELECT sirket FROM calisanlar WHERE isim='Veli Yilmaz');

